<!DOCTYPE html>
<html lang=" en">
  <head>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="https://kit.fontawesome.com/500f51af92.js" crossorigin="anonymous"></script>
  </head><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Go Serverless and save the planet | Taak</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Go Serverless and save the planet" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Complete guide to self-host the Knative platform" />
<meta property="og:description" content="Complete guide to self-host the Knative platform" />
<link rel="canonical" href="https://docs.taakcloud.com/blog/go-serverless-and-save-the-planet/" />
<meta property="og:url" content="https://docs.taakcloud.com/blog/go-serverless-and-save-the-planet/" />
<meta property="og:site_name" content="Taak" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-05-21T08:08:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Go Serverless and save the planet" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-05-21T08:08:00+00:00","datePublished":"2023-05-21T08:08:00+00:00","description":"Complete guide to self-host the Knative platform","headline":"Go Serverless and save the planet","mainEntityOfPage":{"@type":"WebPage","@id":"https://docs.taakcloud.com/blog/go-serverless-and-save-the-planet/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://docs.taakcloud.com/appicon.svg"}},"url":"https://docs.taakcloud.com/blog/go-serverless-and-save-the-planet/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://docs.taakcloud.com/feed.xml" title="Taak" /></head>
<body class=""><header class="site-header" role="banner">

  <div class="wrapper"><section class="top-bar">
      <div class="logo"><a href="/"><svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="512.000000pt" height="512.000000pt"
  viewBox="0 0 512.000000 512.000000" preserveAspectRatio="xMidYMid meet">

  <g transform="translate(0.000000,512.000000) scale(0.100000,-0.100000)" fill="#000000" stroke="none">
    <path d="M2106 4536 c-30 -9 -61 -26 -81 -47 -33 -33 -195 -303 -195 -325 0
-19 38 -46 61 -42 18 2 42 37 109 153 67 115 93 152 116 162 20 8 92 12 229
13 l200 0 -3 -615 c-1 -416 1 -622 8 -635 13 -23 62 -27 79 -6 8 10 11 182 9
635 l-3 621 202 0 c200 0 202 0 231 -25 16 -13 62 -81 101 -150 65 -112 76
-125 100 -125 31 0 51 16 51 41 0 29 -139 262 -179 300 -27 26 -53 40 -90 48
-78 17 -880 14 -945 -3z" fill="#ffffff" />
    <path d="M1390 3760 c-157 -3 -293 -9 -302 -13 -21 -11 -45 -48 -209 -332
-161 -279 -162 -283 -97 -395 24 -41 95 -164 158 -273 74 -128 125 -207 145
-220 29 -21 41 -22 340 -25 327 -4 365 0 402 40 12 13 90 142 173 287 151 262
152 264 147 315 -4 43 -27 90 -152 306 -81 140 -157 265 -168 277 -19 21 -99
45 -135 41 -9 -1 -145 -5 -302 -8z m399 -65 c37 -39 314 -535 314 -563 0 -28
-276 -518 -314 -557 -19 -19 -35 -20 -329 -23 -255 -2 -314 0 -337 12 -35 18
-333 528 -333 570 0 35 263 497 313 549 l36 38 315 -3 c300 -3 316 -4 335 -23z" fill="#ffffff" />
    <path d="M3680 3761 c-240 -5 -290 -9 -310 -22 -14 -9 -58 -74 -99 -145 -237
-410 -241 -417 -241 -456 0 -52 7 -65 172 -347 85 -145 155 -253 171 -265 27
-20 40 -21 362 -21 323 0 334 1 362 21 27 20 261 410 325 541 26 55 28 67 19
95 -6 18 -80 152 -165 298 -110 191 -161 270 -182 282 -40 23 -87 25 -414 19z
m373 -55 c27 -11 54 -52 185 -278 102 -177 152 -275 152 -294 0 -20 -44 -106
-129 -254 -183 -317 -178 -309 -207 -320 -14 -6 -155 -10 -329 -10 -301 0
-304 0 -329 23 -14 12 -86 130 -162 262 -75 132 -141 245 -146 252 -25 31 -10
74 77 225 49 84 118 204 153 266 40 71 73 117 90 127 38 20 597 22 645 1z" fill="#ffffff" />
    <path d="M2523 3100 l-283 -5 -24 -25 c-36 -36 -325 -539 -332 -578 -5 -26 1
-48 28 -100 54 -108 269 -475 292 -501 43 -48 64 -51 388 -51 281 0 304 1 343
20 38 19 53 39 199 292 86 150 160 285 163 300 3 15 0 42 -6 59 -18 51 -299
534 -326 559 -25 24 -83 41 -130 38 -16 -2 -157 -5 -312 -8z m411 -70 c35 -36
316 -531 316 -556 0 -16 -227 -426 -300 -541 -26 -40 -49 -43 -364 -43 -288 0
-305 1 -329 20 -27 22 -318 518 -325 556 -5 28 274 523 320 567 l29 28 314 -3
315 -3 24 -25z" fill="#ffffff" />
    <path d="M1150 2443 c-80 -14 -70 -1 -271 -347 -156 -270 -160 -286 -107 -378
18 -31 89 -154 158 -273 81 -141 136 -225 155 -239 29 -20 42 -21 325 -24 162
-2 314 0 338 3 27 4 54 17 72 33 16 15 97 146 180 291 151 261 152 264 148
315 -4 44 -27 89 -159 315 -92 158 -165 273 -182 285 -27 20 -41 21 -330 22
-166 1 -313 0 -327 -3z m620 -56 c17 -8 67 -85 153 -232 156 -267 189 -333
181 -360 -10 -32 -294 -518 -315 -540 -19 -19 -35 -20 -329 -23 -255 -2 -314
0 -337 12 -35 18 -333 529 -333 570 0 38 298 554 330 571 35 20 612 21 650 2z" fill="#ffffff" />
    <path d="M3417 2441 c-21 -5 -47 -17 -57 -27 -17 -17 -264 -436 -312 -528 -41
-80 -23 -121 276 -623 47 -80 38 -78 412 -78 321 0 334 1 360 21 29 21 324
520 345 581 14 42 2 66 -179 378 -110 190 -146 244 -173 260 -32 19 -54 20
-334 22 -165 1 -317 -2 -338 -6z m641 -55 c36 -19 332 -529 332 -572 0 -20
-40 -99 -118 -235 -65 -112 -133 -230 -151 -262 -51 -90 -43 -88 -401 -85
-294 3 -310 4 -329 23 -21 22 -285 479 -307 532 -16 38 -17 37 170 361 88 152
137 227 155 237 38 21 609 22 649 1z" fill="#ffffff" />
    <path d="M2271 1780 c-18 -4 -44 -19 -57 -32 -35 -34 -323 -537 -330 -576 -5
-26 1 -48 28 -100 57 -112 269 -475 292 -501 43 -48 64 -51 388 -51 281 0 305
1 343 20 38 18 52 39 187 272 187 323 185 319 172 367 -6 21 -79 157 -163 303
-116 201 -160 269 -184 284 -29 17 -56 19 -337 21 -168 1 -320 -2 -339 -7z
m663 -70 c35 -36 316 -530 316 -556 0 -11 -40 -90 -88 -175 -49 -85 -115 -199
-146 -254 -32 -55 -69 -111 -82 -125 l-24 -25 -315 -3 -314 -3 -30 28 c-35 34
-321 530 -321 558 0 11 17 49 38 85 21 36 89 154 151 263 62 108 125 206 139
217 25 20 37 21 339 18 l313 -3 24 -25z" fill="#ffffff" />
  </g>
</svg></a></div>
      <a class="nav-toggle" id="open-nav" href="#">&#9776;</a>
<nav>
	
	

		
		<a href="/" class="">Documentation</a>
	
	

		
		<a href="/about/" class="">About</a>
	
</nav>

    </section>
    <section class="hero_search">
      <h1>Docs</h1>
      <p>Everything you need to know about using Taak APIs and services.</p>
      <form action="/search/" method="get">
	<input type="search" name="q"  placeholder="What would you like to know?" autofocus>
	<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>
	<input type="submit" value="Search" style="display: none;">
</form>
    </section>
  </div>
</header><main class="page-content content" aria-label="Content">
    <div class="wrapper">
      <section class="tutorial">
	<section class="sidebar sticky">
		<ul id="toc" class="section-nav">
<li class="toc-entry toc-h3"><a href="#cloud-native-computing-foundation-cncf">Cloud Native Computing Foundation (CNCF)</a></li>
<li class="toc-entry toc-h2"><a href="#complete-guide-to-self-host-the-knative-platform">Complete guide to self-host the Knative platform</a>
<ul>
<li class="toc-entry toc-h3"><a href="#requirements">Requirements</a></li>
<li class="toc-entry toc-h3"><a href="#tested-environment">Tested environment</a></li>
<li class="toc-entry toc-h3"><a href="#required-dns-records">Required DNS Records</a></li>
<li class="toc-entry toc-h3"><a href="#install-microk8s">Install Microk8s</a></li>
<li class="toc-entry toc-h3"><a href="#istio-as-ingress-controller-and-network-layer-for-knative">Istio as ingress controller and network layer for Knative</a></li>
<li class="toc-entry toc-h3"><a href="#enable-cert-manager-addons">Enable cert-manager addons</a></li>
<li class="toc-entry toc-h3"><a href="#knative-serving-installation">Knative-serving installation</a></li>
<li class="toc-entry toc-h3"><a href="#helloworld-service-for-test-serving">HelloWorld service for test serving</a></li>
<li class="toc-entry toc-h3"><a href="#config-custom-domain-for-helloworld-go-servcie">Config custom domain for helloworld-go servcie</a></li>
</ul>
</li>
</ul>
	</section>
	<section class="tutorial-content">
		<h1>Go Serverless and save the planet</h1>

		
		
		<div class="tutorial-main">
			<p class="tofigure"><img src="/assets/img/go-serverless-and-save-the-planet/cover.jpg" alt="Cover image" title="PHOTO: ILLUSTRATED FOR TERRAFORMATION BY JAMES YAMASAKI"></p>

<p>With Serverless we could scale down to zero, and underlining hardware could be shared between many modules of our applications. Using hardware only when is needed for where is needed the most(with auto scaling) is a key to increase performance while reducing costs. So as result with less servers we do contribute to cooling down the planet. It’s amazing to see that many young people are trying to save the planet from global warming. It seems a power transition is happening(e.g. in Europe) and we could expect a better decisions in continue 🤞. Technologies also could help us in this path and let’s hope we can go forward and become multiplanetary species even. What this post could do today is, to encourage people in software development to consider solutions which are more friendly to planet earth and help each other to adopt those solutions. Having said that some people think Trees are a faster solution to climate change, which frankly is simple and practical for getting into an action ✌.</p>

<h3 id="cloud-native-computing-foundation-cncf">
<a class="anchor" href="#cloud-native-computing-foundation-cncf" aria-hidden="true"><span class="octicon octicon-link"></span></a>Cloud Native Computing Foundation (CNCF)</h3>

<p><a href="https://landscape.cncf.io/serverless?fullscreen=yes&amp;zoom=150" target="\_blank" rel="noopener noreferrer">landscape.cncf.io/serverless <i class="fa-solid fa-arrow-up-right-from-square"></i></a> is a great place to see what is happening with Serverless world and to compare projects based on stars, commit frequencies, etc. It worth your time to evaluate available options and comparing them before adopting them. And/or find a domain expert in the Serverless world and follow their advises.</p>

<h4 id="knative-platform">Knative platform</h4>

<p>In this post we are going to install <a href="https://knative.dev/" target="\_blank" rel="noopener noreferrer">Knative platform <i class="fa-solid fa-arrow-up-right-from-square"></i></a> and config it for production use with minimum required hardware. Why Knative? for me it was <a href="https://www.salaboy.com/2021/11/30/my-story-with-knative/" target="\_blank" rel="noopener noreferrer">this post <i class="fa-solid fa-arrow-up-right-from-square"></i></a> at first and after reading <a href="http://mng.bz/jjKP" target="\_blank" rel="noopener noreferrer">Continuous Delivery for Kubernetes <i class="fa-solid fa-arrow-up-right-from-square"></i></a> book, I was sure Kubernetes and Knative need to be in my Serverless adventure’s backpack. Plus I do live in a 3rd world country, which means no AWS, no easy access to ready to use public cloud providers. But renting a server(with below spec) could be as cheap as $8 a month. So some people are forced to go with self-host option and this post may help them.</p>

<h2 id="complete-guide-to-self-host-the-knative-platform">
<a class="anchor" href="#complete-guide-to-self-host-the-knative-platform" aria-hidden="true"><span class="octicon octicon-link"></span></a>Complete guide to self-host the Knative platform</h2>

<h3 id="requirements">
<a class="anchor" href="#requirements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Requirements</h3>

<ul class="task-list">
  <li class="task-list-item">
<input type="checkbox" class="task-list-item-checkbox" disabled checked>A server with a public IP(v4) address (e.g. 13.49.80.99)
    <ul>
      <li>8 core CPU (6 core could work also)</li>
      <li>16G ram (6G could work also)</li>
      <li>30G disk (make sure you could add more storage if needed)</li>
    </ul>
  </li>
  <li class="task-list-item">
<input type="checkbox" class="task-list-item-checkbox" disabled checked>A domain name (e.g. example.com)</li>
</ul>

<p>First make sure your server doesn’t not have any limitation to access internet and docker registries<!--, and if it does maybe [this post <i class="fa-solid fa-arrow-up-right-from-square"/>](){:target="_blank"}{:rel="noopener noreferrer"} could help you-->.</p>

<h3 id="tested-environment">
<a class="anchor" href="#tested-environment" aria-hidden="true"><span class="octicon octicon-link"></span></a>Tested environment</h3>

<ul class="task-list">
  <li class="task-list-item">
<input type="checkbox" class="task-list-item-checkbox" disabled checked>Ubuntu 20.04 LTS</li>
  <li class="task-list-item">
<input type="checkbox" class="task-list-item-checkbox" disabled checked>Microk8s 1.27/stable</li>
  <li class="task-list-item">
<input type="checkbox" class="task-list-item-checkbox" disabled checked>Istio 1.17.2</li>
  <li class="task-list-item">
<input type="checkbox" class="task-list-item-checkbox" disabled checked>Knative 1.10.1</li>
</ul>

<h3 id="required-dns-records">
<a class="anchor" href="#required-dns-records" aria-hidden="true"><span class="octicon octicon-link"></span></a>Required DNS Records</h3>

<p>Following screenshot shows required type <em>A</em> DNS Records.</p>

<p class="tofigure"><img src="/assets/img/go-serverless-and-save-the-planet/dns-records.png" alt="A DNS Records" title="A DNS Records (at cloudflare)"></p>

<h3 id="install-microk8s">
<a class="anchor" href="#install-microk8s" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install Microk8s</h3>

<p>Microk8s is known as a lightweight Kubernetes which is optimized to use minium possible resources and still offers what a normal Kubernetes could do. so it somehow matches with our overall goal to go Serverless with less servers.</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>snap <span class="nb">install </span>microk8s <span class="nt">--classic</span> <span class="nt">--channel</span><span class="o">=</span>1.27/stable</code></pre></figure>

<p>At the moment version 1.27 is the latest stable version of Microk8s, you could check <a href="https://microk8s.io/docs/setting-snap-channel" target="\_blank" rel="noopener noreferrer">here <i class="fa-solid fa-arrow-up-right-from-square"></i></a> to choose the right channel. And please note, different version, might have it’s own differences in continue, and obviously you might face an issue, which we didn’t.</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>usermod <span class="nt">-a</span> <span class="nt">-G</span> microk8s <span class="nv">$USER</span>
<span class="nb">sudo chown</span> <span class="nt">-f</span> <span class="nt">-R</span> <span class="nv">$USER</span> ~/.kube
su - <span class="nv">$USER</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">microk8s status <span class="nt">--wait-ready</span></code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">microk8s is running
high-availability: no
  datastore master nodes: 127.0.0.1:19001
  datastore standby nodes: none
addons:
  enabled:
    dns                  <span class="c"># (core) CoreDNS</span>
    ha-cluster           <span class="c"># (core) Configure high availability on the current node</span>
    helm                 <span class="c"># (core) Helm - the package manager for Kubernetes</span>
    helm3                <span class="c"># (core) Helm 3 - the package manager for Kubernetes</span>
  disabled:
    cert-manager         <span class="c"># (core) Cloud native certificate management</span>
    community            <span class="c"># (core) The community addons repository</span>
    dashboard            <span class="c"># (core) The Kubernetes dashboard</span>
    gpu                  <span class="c"># (core) Automatic enablement of Nvidia CUDA</span>
    host-access          <span class="c"># (core) Allow Pods connecting to Host services smoothly</span>
    hostpath-storage     <span class="c"># (core) Storage class; allocates storage from host directory</span>
    ingress              <span class="c"># (core) Ingress controller for external access</span>
    kube-ovn             <span class="c"># (core) An advanced network fabric for Kubernetes</span>
    mayastor             <span class="c"># (core) OpenEBS MayaStor</span>
    metallb              <span class="c"># (core) Loadbalancer for your Kubernetes cluster</span>
    metrics-server       <span class="c"># (core) K8s Metrics Server for API access to service metrics</span>
    minio                <span class="c"># (core) MinIO object storage</span>
    observability        <span class="c"># (core) A lightweight observability stack for logs, traces and metrics</span>
    prometheus           <span class="c"># (core) Prometheus operator for monitoring and logging</span>
    rbac                 <span class="c"># (core) Role-Based Access Control for authorisation</span>
    registry             <span class="c"># (core) Private image registry exposed on localhost:32000</span>
    storage              <span class="c"># (core) Alias to hostpath-storage add-on, deprecated</span></code></pre></figure>

</details>

<h4 id="optional---disabling-ha-cluster">Optional - disabling ha-cluster</h4>

<p>Personally I think if you don’t have a fast private network between your servers or you don’t have a fast storage shared between your servers then Microk8s high availability feature might not work quite well as expected. In my case CPU usage was about 20% always busy. Unfortunately this decision is not something you could change later in your deployment, switch between ha-cluster and none ha-cluster will reset your cluster to initial state(removes everything!). In this setup we are going to have 1 server 1 node, and we prefer less cpu usage, so we did use following command to disable it.</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">microk8s disable ha-cluster <span class="nt">--force</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">microk8s kubectl get all <span class="nt">-A</span></code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">NAMESPACE   NAME                 TYPE        CLUSTER-IP     EXTERNAL-IP   PORT<span class="o">(</span>S<span class="o">)</span>   AGE
default     service/kubernetes   ClusterIP   10.152.183.1   &lt;none&gt;        443/TCP   77s</code></pre></figure>

</details>

<h5 id="re-enable-dns-addons">Re-enable dns addons</h5>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">microk8s <span class="nb">enable </span>dns</code></pre></figure>

<h3 id="istio-as-ingress-controller-and-network-layer-for-knative">
<a class="anchor" href="#istio-as-ingress-controller-and-network-layer-for-knative" aria-hidden="true"><span class="octicon octicon-link"></span></a>Istio as ingress controller and network layer for Knative</h3>

<p>In this guide we are going to use Istioctl to install Istio and we will have <em>istio-system</em> and <em>istio-ingress</em> namespaces separated for having better security.</p>

<p>First we need to copy Microk8s config to default place for current user</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">mkdir</span> <span class="nt">-p</span> ~/.kube
microk8s config <span class="o">&gt;</span> ~/.kube/config</code></pre></figure>

<p>Then add kubectl alias</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">alias </span><span class="nv">kubectl</span><span class="o">=</span><span class="s1">'microk8s kubectl'</span></code></pre></figure>

<p class="right"><em>~/.bashrc</em></p>

<p>Or install kubectl by following command (if you want to use <a href="https://krew.sigs.k8s.io/" target="\_blank" rel="noopener noreferrer">krew <i class="fa-solid fa-arrow-up-right-from-square"></i></a> plugins)</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">sudo </span>snap <span class="nb">install </span>kubectl <span class="nt">--classic</span></code></pre></figure>

<p>Then</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">mkdir</span> ~/etc
<span class="nb">cd</span> ~/etc
curl <span class="nt">-L</span> https://istio.io/downloadIstio | sh -
<span class="nb">cd</span> ~/etc/istio-1.17.2/
<span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span><span class="nv">$PWD</span>/bin:<span class="nv">$PATH</span>
istioctl <span class="nb">install</span> <span class="nt">--set</span> <span class="nv">profile</span><span class="o">=</span>minimal <span class="nt">-y</span></code></pre></figure>

<p>Check installation</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl get all <span class="nt">-n</span> istio-system</code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">NAME                         READY   STATUS    RESTARTS   AGE
pod/istiod-57c965889-pdpv5   1/1     Running   0          28m

NAME TYPE CLUSTER-IP EXTERNAL-IP PORT<span class="o">(</span>S<span class="o">)</span> AGE
service/istiod ClusterIP 10.152.183.139 &lt;none&gt; 15010/TCP,15012/TCP,443/TCP,15014/TCP 28m

NAME READY UP-TO-DATE AVAILABLE AGE
deployment.apps/istiod 1/1 1 1 28m

NAME DESIRED CURRENT READY AGE
replicaset.apps/istiod-57c965889 1 1 1 28m

NAME REFERENCE TARGETS MINPODS MAXPODS REPLICAS AGE
horizontalpodautoscaler.autoscaling/istiod Deployment/istiod &lt;unknown&gt;/80% 1 5 1 28m</code></pre></figure>


</details>

<h4 id="install-istio-ingress-with-istiooperator">Install istio-ingress with IstioOperator</h4>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">istioctl operator init</code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">Installing operator controller <span class="k">in </span>namespace: istio-operator using image: docker.io/istio/operator:1.17.2
Operator controller will watch namespaces: istio-system
✔ Istio operator installed
✔ Installation <span class="nb">complete</span></code></pre></figure>

</details>

<details open=""><summary>istio-ingress-operator.yaml</summary>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">install.istio.io/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">IstioOperator</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">ingress</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">istio-system</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">profile</span><span class="pi">:</span> <span class="s">empty</span> <span class="c1"># Do not install CRDs or the control plane</span>
  <span class="na">components</span><span class="pi">:</span>
    <span class="na">ingressGateways</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">istio-ingressgateway</span>
      <span class="na">namespace</span><span class="pi">:</span> <span class="s">istio-ingress</span>
      <span class="na">enabled</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">label</span><span class="pi">:</span>
        <span class="c1"># Set a unique label for the gateway. This is required to ensure Gateways</span>
        <span class="c1"># can select this workload</span>
        <span class="na">istio</span><span class="pi">:</span> <span class="s">ingressgateway</span>
  <span class="na">values</span><span class="pi">:</span>
    <span class="na">gateways</span><span class="pi">:</span>
      <span class="na">istio-ingressgateway</span><span class="pi">:</span>
        <span class="c1"># Enable gateway injection</span>
        <span class="na">injectionTemplate</span><span class="pi">:</span> <span class="s">gateway</span></code></pre></figure>

</details>
<p class="right"><em>istio-ingress-operator.yaml</em></p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl create ns istio-ingress
kubectl apply <span class="nt">-f</span> istio-ingress-operator.yaml</code></pre></figure>

<p>Verify is ready</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl get all <span class="nt">-n</span> istio-ingress</code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">NAME                                        READY   STATUS    RESTARTS   AGE
pod/istio-ingressgateway-77b5b78896-bwvjw   1/1     Running   0          4m48s

NAME TYPE CLUSTER-IP EXTERNAL-IP PORT<span class="o">(</span>S<span class="o">)</span> AGE
service/istio-ingressgateway LoadBalancer 10.152.183.50 &lt;pending&gt; 15021:30688/TCP,80:30792/TCP,443:32182/TCP 4m48s

NAME READY UP-TO-DATE AVAILABLE AGE
deployment.apps/istio-ingressgateway 1/1 1 1 4m48s

NAME DESIRED CURRENT READY AGE
replicaset.apps/istio-ingressgateway-77b5b78896 1 1 1 4m48s

NAME REFERENCE TARGETS MINPODS MAXPODS REPLICAS AGE
horizontalpodautoscaler.autoscaling/istio-ingressgateway Deployment/istio-ingressgateway &lt;unknown&gt;/80% 1 5 1 4m48s</code></pre></figure>


</details>

<h4 id="enable-metallb-addons">Enable metallb addons</h4>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">microk8s <span class="nb">enable </span>metallb:10.0.0.5-10.0.0.250</code></pre></figure>

<p>After successful installation, then your service must resolve external-ip from bare metal load balancer</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl get svc <span class="nt">-n</span> istio-ingress</code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">NAME                   TYPE           CLUSTER-IP      EXTERNAL-IP   PORT<span class="o">(</span>S<span class="o">)</span>                                      AGE
istio-ingressgateway   LoadBalancer   10.152.183.50   10.0.0.5      15021:30688/TCP,80:30792/TCP,443:32182/TCP   17m</code></pre></figure>

</details>

<h4 id="bind-istio-ingressgateway-to-host-port-80-and-443">Bind istio-ingressgateway to host port 80 and 443</h4>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl edit deploy istio-ingressgateway <span class="nt">-n</span> istio-ingress</code></pre></figure>

<details open=""><summary>istio-ingressgateway</summary>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">spec</span><span class="pi">:</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">env</span><span class="pi">:</span>
        <span class="na">ports</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">containerPort</span><span class="pi">:</span> <span class="m">15021</span>
          <span class="na">protocol</span><span class="pi">:</span> <span class="s">TCP</span>
        <span class="pi">-</span> <span class="na">containerPort</span><span class="pi">:</span> <span class="m">8080</span>
          <span class="na">hostPort</span><span class="pi">:</span> <span class="m">80</span>          <span class="c1"># &lt;- Add this line</span>
          <span class="na">protocol</span><span class="pi">:</span> <span class="s">TCP</span>
        <span class="pi">-</span> <span class="na">containerPort</span><span class="pi">:</span> <span class="m">8443</span>
          <span class="na">hostPort</span><span class="pi">:</span> <span class="m">443</span>         <span class="c1"># &lt;- Add this line too</span></code></pre></figure>


</details>

<p>Please note because of this binding, we can’t scale more than one pod for a node, so in our case we set <em>replicas</em> to 1. And for production environment with more thant one node, we could set <em>replicas</em> to count of nodes and with a logic that each node should have one <em>istio-ingressgateway</em> pod.</p>

<h3 id="enable-cert-manager-addons">
<a class="anchor" href="#enable-cert-manager-addons" aria-hidden="true"><span class="octicon octicon-link"></span></a>Enable cert-manager addons</h3>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">microk8s <span class="nb">enable </span>cert-manager</code></pre></figure>

<p>Verify is ready</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl get all <span class="nt">-n</span> cert-manager</code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">NAME                                           READY   STATUS    RESTARTS   AGE
pod/cert-manager-5d6bc46969-btqdd              1/1     Running   0          5m58s
pod/cert-manager-cainjector-7d8b8bb6b8-rjsx5   1/1     Running   0          5m58s
pod/cert-manager-webhook-5c5c5bb457-6zjcp      1/1     Running   0          5m58s

NAME TYPE CLUSTER-IP EXTERNAL-IP PORT<span class="o">(</span>S<span class="o">)</span> AGE
service/cert-manager ClusterIP 10.152.183.71 &lt;none&gt; 9402/TCP 5m58s
service/cert-manager-webhook ClusterIP 10.152.183.177 &lt;none&gt; 443/TCP 5m58s

NAME READY UP-TO-DATE AVAILABLE AGE
deployment.apps/cert-manager 1/1 1 1 5m58s
deployment.apps/cert-manager-cainjector 1/1 1 1 5m58s
deployment.apps/cert-manager-webhook 1/1 1 1 5m58s

NAME DESIRED CURRENT READY AGE
replicaset.apps/cert-manager-5d6bc46969 1 1 1 5m58s
replicaset.apps/cert-manager-cainjector-7d8b8bb6b8 1 1 1 5m58s
replicaset.apps/cert-manager-webhook-5c5c5bb457 1 1 1 5m58s</code></pre></figure>


</details>

<h4 id="zerossl-clusterissuer">Zerossl ClusterIssuer</h4>

<details open=""><summary>zerossl-cluster-issuer.yaml</summary>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Secret</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">cert-manager</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">zerossl-eab</span>
<span class="na">stringData</span><span class="pi">:</span>
  <span class="na">secret</span><span class="pi">:</span> <span class="s">&lt;CHANGE-TO-ACTUAL-SECRET&gt;</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Secret</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">cert-manager</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">cloudflare-api-token</span>
<span class="na">type</span><span class="pi">:</span> <span class="s">Opaque</span>
<span class="na">stringData</span><span class="pi">:</span>
  <span class="na">api-token</span><span class="pi">:</span> <span class="s">&lt;CHANGE-TO-ACTUAL-CLOUDFLARE-API-TOKEN&gt;</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">cert-manager.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">ClusterIssuer</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">zerossl-prod</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">acme</span><span class="pi">:</span>
    <span class="c1"># The ACME server URL</span>
    <span class="na">server</span><span class="pi">:</span> <span class="s">https://acme.zerossl.com/v2/DV90</span>
    <span class="na">externalAccountBinding</span><span class="pi">:</span>
      <span class="na">keyID</span><span class="pi">:</span> <span class="s">&lt;CHANGE-TO-ACTUAL-KEY-ID&gt;</span>
      <span class="na">keySecretRef</span><span class="pi">:</span>
        <span class="na">name</span><span class="pi">:</span> <span class="s">zerossl-eab</span>
        <span class="na">key</span><span class="pi">:</span> <span class="s">secret</span>
    <span class="c1"># Name of a secret used to store the ACME account private key</span>
    <span class="na">privateKeySecretRef</span><span class="pi">:</span>
      <span class="na">name</span><span class="pi">:</span> <span class="s">zerossl-prod</span>
    <span class="na">solvers</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">dns01</span><span class="pi">:</span>
        <span class="na">cloudflare</span><span class="pi">:</span>
          <span class="na">apiTokenSecretRef</span><span class="pi">:</span>
            <span class="na">name</span><span class="pi">:</span> <span class="s">cloudflare-api-token</span>
            <span class="na">key</span><span class="pi">:</span> <span class="s">api-token</span></code></pre></figure>

</details>
<p class="right"><em>zerossl-cluster-issuer.yaml</em></p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl apply <span class="nt">-f</span> zerossl-cluster-issuer.yaml</code></pre></figure>

<p>Verify is ready</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl get ClusterIssuer</code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">NAME           READY   AGE
zerossl-prod   True    6s</code></pre></figure>

</details>

<h4 id="certificate-for-istio-ingress-namespace">Certificate for istio-ingress namespace</h4>

<details open=""><summary>certificate.yaml</summary>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">cert-manager.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Certificate</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">generation</span><span class="pi">:</span> <span class="m">1</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">star-example-com-tls</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">istio-ingress</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">dnsNames</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">example.com"</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">*.example.com"</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">*.s.example.com"</span>
  <span class="pi">-</span> <span class="s2">"</span><span class="s">*.default.s.example.com"</span>
  <span class="na">issuerRef</span><span class="pi">:</span>
    <span class="na">group</span><span class="pi">:</span> <span class="s">cert-manager.io</span>
    <span class="na">kind</span><span class="pi">:</span> <span class="s">ClusterIssuer</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">zerossl-prod</span>
  <span class="na">secretName</span><span class="pi">:</span> <span class="s">star-example-com-tls</span>
  <span class="na">usages</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">digital signature</span>
  <span class="pi">-</span> <span class="s">key encipherment</span></code></pre></figure>

</details>
<p class="right"><em>certificate.yaml</em></p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl apply <span class="nt">-f</span> certificate.yaml</code></pre></figure>

<p>Verify is ready</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl get Certificate <span class="nt">-n</span> istio-ingress</code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">NAME                     READY   SECRET                   AGE
star-example-com-tls   True    star-example-com-tls   7m38s</code></pre></figure>

</details>

<h4 id="istio-ingressclass">Istio IngressClass</h4>

<details open=""><summary>istio-ingress-class.yaml</summary>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">networking.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">IngressClass</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">istio</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">controller</span><span class="pi">:</span> <span class="s">istio.io/ingress-controller</span></code></pre></figure>

</details>
<p class="right"><em>istio-ingress-class.yaml</em></p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl apply <span class="nt">-f</span> istio-ingress-class.yaml</code></pre></figure>

<p>Verify is ready</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl get IngressClass</code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">NAME    CONTROLLER                    PARAMETERS   AGE
istio   istio.io/ingress-controller   &lt;none&gt;       9s</code></pre></figure>

</details>

<h4 id="optional---nfs-persistent-volumes">Optional - NFS Persistent Volumes</h4>

<p>In continue we are going to use NFS persistent volumes, and <a href="https://microk8s.io/docs/nfs" target="\_blank" rel="noopener noreferrer">this doc <i class="fa-solid fa-arrow-up-right-from-square"></i></a> shows required steps and at the end you should be able to run following command and compare your output.</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">microk8s kubectl get storageclass</code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">NAME                PROVISIONER      RECLAIMPOLICY   VOLUMEBINDINGMODE   ALLOWVOLUMEEXPANSION   AGE
nfs-csi <span class="o">(</span>default<span class="o">)</span>   nfs.csi.k8s.io   Delete          Immediate           <span class="nb">true                   </span>72s</code></pre></figure>

</details>

<p>If your StorageClass is not mark as default, you could use following command.</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">microk8s kubectl patch storageclass nfs-csi <span class="nt">-p</span> <span class="s1">'{"metadata": {"annotations":{"storageclass.kubernetes.io/is-default-class":"true"}}}'</span></code></pre></figure>

<h4 id="optional---enable-registry-addons">Optional - Enable registry addons</h4>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">microk8s <span class="nb">enable </span>registry</code></pre></figure>

</details>

<h5 id="registry-ingress">Registry ingress</h5>

<details open=""><summary>registry-ingress.yaml</summary>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">networking.k8s.io/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Ingress</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">registry</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">container-registry</span>
  <span class="na">annotations</span><span class="pi">:</span>
    <span class="na">kubernetes.io/ingress.class</span><span class="pi">:</span> <span class="s">istio</span>
    <span class="na">cert-manager.io/cluster-issuer</span><span class="pi">:</span> <span class="s2">"</span><span class="s">zerossl-prod"</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">rules</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">host</span><span class="pi">:</span> <span class="s">reg.example.com</span>
    <span class="na">http</span><span class="pi">:</span>
      <span class="na">paths</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">path</span><span class="pi">:</span> <span class="s">/</span>
        <span class="na">pathType</span><span class="pi">:</span> <span class="s">Prefix</span>
        <span class="na">backend</span><span class="pi">:</span>
          <span class="na">service</span><span class="pi">:</span>
            <span class="na">name</span><span class="pi">:</span> <span class="s">registry</span>
            <span class="na">port</span><span class="pi">:</span>
              <span class="na">number</span><span class="pi">:</span> <span class="m">5000</span>
  <span class="na">tls</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">hosts</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="s">reg.example.com</span>
    <span class="na">secretName</span><span class="pi">:</span> <span class="s">star-example-com-tls</span></code></pre></figure>

</details>
<p class="right"><em>registry-ingress.yaml</em></p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl apply <span class="nt">-f</span> registry-ingress.yaml</code></pre></figure>

<p>Verify is ready</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl get ingress <span class="nt">-n</span> container-registry</code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">NAME       CLASS    HOSTS               ADDRESS   PORTS     AGE
registry   &lt;none&gt;   reg.example.com             80, 443   5m39s</code></pre></figure>

</details>
<p>At this point you should be able to access your server from outside over https protocol</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">curl https://reg.example.com/v2/</code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{}</span></code></pre></figure>

</details>

<h3 id="knative-serving-installation">
<a class="anchor" href="#knative-serving-installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Knative-serving installation</h3>

<p>We are going to <a href="https://knative.dev/docs/install/operator/knative-with-operators/" target="\_blank" rel="noopener noreferrer">install Knative by using Knative Operator <i class="fa-solid fa-arrow-up-right-from-square"></i></a> and latest version at the time is 1.10.1.</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl apply <span class="nt">-f</span> https://github.com/knative/operator/releases/download/knative-v1.10.1/operator.yaml</code></pre></figure>

<p>Verify is ready</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl get deployment knative-operator <span class="nt">-n</span> default</code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">NAME               READY   UP-TO-DATE   AVAILABLE   AGE
knative-operator   1/1     1            1           12m</code></pre></figure>

</details>

<details open=""><summary>knative-serving.yaml</summary>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Namespace</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">knative-serving</span>
<span class="nn">---</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s">operator.knative.dev/v1beta1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">KnativeServing</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">knative-serving</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">knative-serving</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1.10"</span>
  <span class="na">ingress</span><span class="pi">:</span>
    <span class="na">istio</span><span class="pi">:</span>
      <span class="na">enabled</span><span class="pi">:</span> <span class="no">true</span>
  <span class="na">config</span><span class="pi">:</span>
    <span class="na">domain</span><span class="pi">:</span>
      <span class="s2">"</span><span class="s">s.example.com"</span><span class="err">:</span> <span class="s2">"</span><span class="s">"</span>
    <span class="na">network</span><span class="pi">:</span>
      <span class="na">auto-tls</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Enabled"</span>
      <span class="na">autocreate-cluster-domain-claims</span><span class="pi">:</span> <span class="s2">"</span><span class="s">true"</span>
      <span class="na">namespace-wildcard-cert-selector</span><span class="pi">:</span> <span class="s1">'</span><span class="s">{"matchExpressions":</span><span class="nv"> </span><span class="s">[{"key":"networking.knative.dev/enableWildcardCert",</span><span class="nv"> </span><span class="s">"operator":</span><span class="nv"> </span><span class="s">"In",</span><span class="nv"> </span><span class="s">"values":["true"]}]}'</span>
    <span class="na">istio</span><span class="pi">:</span>
      <span class="na">gateway.knative-serving.knative-ingress-gateway</span><span class="pi">:</span> <span class="s2">"</span><span class="s">istio-ingressgateway.istio-ingress.svc.cluster.local"</span>
      <span class="na">local-gateway.knative-serving.knative-local-gateway</span><span class="pi">:</span> <span class="s2">"</span><span class="s">knative-local-gateway.istio-ingress.svc.cluster.local"</span>
    <span class="na">certmanager</span><span class="pi">:</span>
      <span class="na">issuerRef</span><span class="pi">:</span> <span class="pi">|</span>
        <span class="s">kind: ClusterIssuer</span>
        <span class="s">name: zerossl-prod</span></code></pre></figure>

</details>
<p class="right"><em>knative-serving.yaml</em></p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl apply <span class="nt">-f</span> knative-serving.yaml</code></pre></figure>

<p>Verify is ready</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl get KnativeServing knative-serving <span class="nt">-n</span> knative-serving</code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">NAME              VERSION   READY   REASON
knative-serving   1.10.1    True</code></pre></figure>

</details>

<h4 id="knative-istio-integration">Knative istio integration</h4>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl apply <span class="nt">-f</span> https://github.com/knative/net-istio/releases/download/knative-v1.10.0/net-istio.yaml</code></pre></figure>

<details open=""><summary>knative-peer-authentication.yaml</summary>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">v1</span>
<span class="na">apiVersion</span><span class="pi">:</span> <span class="s2">"</span><span class="s">security.istio.io/v1beta1"</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s2">"</span><span class="s">PeerAuthentication"</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s2">"</span><span class="s">default"</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s2">"</span><span class="s">knative-serving"</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">mtls</span><span class="pi">:</span>
    <span class="na">mode</span><span class="pi">:</span> <span class="s">PERMISSIVE</span></code></pre></figure>

</details>
<p class="right"><em>knative-peer-authentication.yaml</em></p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl apply <span class="nt">-f</span> knative-peer-authentication.yaml</code></pre></figure>

<h4 id="knative-cert-manager-integration">Knative cert-manager integration</h4>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl apply <span class="nt">-f</span> https://github.com/knative/net-certmanager/releases/download/knative-v1.10.0/release.yaml</code></pre></figure>

<p>Verify is ready</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl get deployment net-certmanager-controller <span class="nt">-n</span> knative-serving</code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">NAME                         READY   UP-TO-DATE   AVAILABLE   AGE
net-certmanager-controller   1/1     1            1           95s</code></pre></figure>

</details>

<h5 id="enable-wildcard-certificate-for-default-namespace">Enable wildcard Certificate for default namespace</h5>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl label ns default networking.knative.dev/enableWildcardCert<span class="o">=</span><span class="nb">true</span></code></pre></figure>

<h4 id="ensure-configmaps-updated-successfully">Ensure configmaps updated successfully</h4>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl get configmap config-istio <span class="nt">-n</span> knative-serving <span class="nt">-o</span> yaml
kubectl get configmap config-domain <span class="nt">-n</span> knative-serving <span class="nt">-o</span> yaml
kubectl get configmap config-network <span class="nt">-n</span> knative-serving <span class="nt">-o</span> yaml
kubectl get configmap config-certmanager <span class="nt">-n</span> knative-serving <span class="nt">-o</span> yaml</code></pre></figure>

<h3 id="helloworld-service-for-test-serving">
<a class="anchor" href="#helloworld-service-for-test-serving" aria-hidden="true"><span class="octicon octicon-link"></span></a>HelloWorld service for test serving</h3>

<details open=""><summary>hello-service.yaml</summary>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">serving.knative.dev/v1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">Service</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">helloworld-go</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">default</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">template</span><span class="pi">:</span>
    <span class="na">spec</span><span class="pi">:</span>
      <span class="na">containers</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">image</span><span class="pi">:</span> <span class="s">ghcr.io/knative/helloworld-go:latest</span>
          <span class="na">env</span><span class="pi">:</span>
            <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">TARGET</span>
              <span class="na">value</span><span class="pi">:</span> <span class="s2">"</span><span class="s">Go</span><span class="nv"> </span><span class="s">Sample</span><span class="nv"> </span><span class="s">v1"</span></code></pre></figure>

</details>
<p class="right"><em>hello-service.yaml</em></p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl apply <span class="nt">-f</span> hello-service.yaml</code></pre></figure>

<p>Verify is ready</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kctl get ksvc <span class="nt">-n</span> default</code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">NAME            URL                                             LATESTCREATED         LATESTREADY           READY   REASON
helloworld-go   https://helloworld-go.default.s.example.com   helloworld-go-00001   helloworld-go-00001   True</code></pre></figure>

</details>

<p>Finally test helloworld service to be accessible from outside</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">curl https://helloworld-go.default.s.example.com</code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">Hello Go Sample v1!</code></pre></figure>

</details>

<h3 id="config-custom-domain-for-helloworld-go-servcie">
<a class="anchor" href="#config-custom-domain-for-helloworld-go-servcie" aria-hidden="true"><span class="octicon octicon-link"></span></a>Config custom domain for helloworld-go servcie</h3>

<details open=""><summary>hello-domain-mapping.yaml</summary>

<figure class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">serving.knative.dev/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">DomainMapping</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">hello.example.com</span>
  <span class="na">namespace</span><span class="pi">:</span> <span class="s">default</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">ref</span><span class="pi">:</span>
    <span class="na">name</span><span class="pi">:</span> <span class="s">helloworld-go</span>
    <span class="na">kind</span><span class="pi">:</span> <span class="s">Service</span>
    <span class="na">apiVersion</span><span class="pi">:</span> <span class="s">serving.knative.dev/v1</span></code></pre></figure>

</details>
<p class="right"><em>hello-domain-mapping.yaml</em></p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl apply <span class="nt">-f</span> hello-domain-mapping.yaml</code></pre></figure>

<p>Verify is ready</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kctl get domainmapping <span class="nt">-n</span> default</code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">NAME                  URL                           READY   REASON
hello.example.com   https://hello.example.com   True</code></pre></figure>

</details>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">curl https://hello.example.com</code></pre></figure>

<details open=""><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">Hello Go Sample v1!</code></pre></figure>

</details>

<p>That’s all, in this post we did deploy a Knative service and make it securely available to our customers 🍻.</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">kubectl get all <span class="nt">-A</span></code></pre></figure>

<details><summary>output</summary>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell">NAMESPACE            NAME                                             READY   STATUS    RESTARTS         AGE
cert-manager         pod/cert-manager-5d6bc46969-btqdd                1/1     Running   1 <span class="o">(</span>5h51m ago<span class="o">)</span>    24h
cert-manager         pod/cert-manager-cainjector-7d8b8bb6b8-rjsx5     1/1     Running   1 <span class="o">(</span>5h50m ago<span class="o">)</span>    24h
cert-manager         pod/cert-manager-webhook-5c5c5bb457-6zjcp        1/1     Running   0                24h
container-registry   pod/registry-9865b655c-ftngg                     1/1     Running   0                23h
default              pod/knative-operator-7b7d4bbc7d-pj48l            1/1     Running   0                22h
default              pod/operator-webhook-74d9489bf8-7vdhr            1/1     Running   0                22h
istio-ingress        pod/istio-ingressgateway-7f5958c7d9-l2qfc        1/1     Running   0                24h
istio-operator       pod/istio-operator-79d6df8f9d-m9zkw              1/1     Running   3 <span class="o">(</span>5h51m ago<span class="o">)</span>    25h
istio-system         pod/istiod-57c965889-pdpv5                       1/1     Running   0                29h
knative-serving      pod/activator-658c5747b-zzvjm                    1/1     Running   0                21h
knative-serving      pod/autoscaler-f989fbf86-fzszz                   1/1     Running   0                21h
knative-serving      pod/autoscaler-hpa-5d7668d747-gs6zs              1/1     Running   0                21h
knative-serving      pod/controller-64b9dcc975-h4vnq                  1/1     Running   0                21h
knative-serving      pod/domain-mapping-7b87f895b6-zxbkk              1/1     Running   0                21h
knative-serving      pod/domainmapping-webhook-54cddcb594-xxmgl       1/1     Running   0                21h
knative-serving      pod/net-certmanager-controller-575898d58-bv6x5   1/1     Running   0                20h
knative-serving      pod/net-certmanager-webhook-7cd899c855-pps7t     1/1     Running   0                20h
knative-serving      pod/net-istio-controller-84cb8b59fb-dxvgq        1/1     Running   0                21h
knative-serving      pod/net-istio-webhook-8d785b78d-jwqqf            1/1     Running   0                21h
knative-serving      pod/webhook-7698bcf68f-qxd7f                     1/1     Running   0                21h
kube-system          pod/coredns-7745f9f87f-lswgs                     1/1     Running   2 <span class="o">(</span>28h ago<span class="o">)</span>      47h
kube-system          pod/csi-nfs-controller-6f844cdc89-slhdt          3/3     Running   12 <span class="o">(</span>5h51m ago<span class="o">)</span>   30h
kube-system          pod/csi-nfs-node-r6h7c                           3/3     Running   6 <span class="o">(</span>28h ago<span class="o">)</span>      30h
kube-system          pod/hostpath-provisioner-58694c9f4b-ztmgq        1/1     Running   3 <span class="o">(</span>5h51m ago<span class="o">)</span>    23h
metallb-system       pod/controller-8467d88d69-sqlsf                  1/1     Running   0                25h
metallb-system       pod/speaker-j4b5r                                1/1     Running   0                25h

NAMESPACE NAME TYPE CLUSTER-IP EXTERNAL-IP PORT<span class="o">(</span>S<span class="o">)</span> AGE
cert-manager service/cert-manager ClusterIP 10.152.183.71 &lt;none&gt; 9402/TCP 24h
cert-manager service/cert-manager-webhook ClusterIP 10.152.183.177 &lt;none&gt; 443/TCP 24h
container-registry service/registry NodePort 10.152.183.166 &lt;none&gt; 5000:32000/TCP 23h
default service/helloworld-go ExternalName &lt;none&gt; knative-local-gateway.istio-ingress.svc.cluster.local 80/TCP 19h
default service/helloworld-go-00001 ClusterIP 10.152.183.45 &lt;none&gt; 80/TCP,443/TCP 19h
default service/helloworld-go-00001-private ClusterIP 10.152.183.68 &lt;none&gt; 80/TCP,443/TCP,9090/TCP,9091/TCP,8022/TCP,8012/TCP 19h
default service/kubernetes ClusterIP 10.152.183.1 &lt;none&gt; 443/TCP 47h
default service/operator-webhook ClusterIP 10.152.183.107 &lt;none&gt; 9090/TCP,8008/TCP,443/TCP 22h
istio-ingress service/istio-ingressgateway LoadBalancer 10.152.183.50 10.0.0.5 15021:30688/TCP,80:30792/TCP,443:32182/TCP 25h
istio-ingress service/knative-local-gateway ClusterIP 10.152.183.228 &lt;none&gt; 80/TCP 21h
istio-operator service/istio-operator ClusterIP 10.152.183.132 &lt;none&gt; 8383/TCP 25h
istio-system service/istiod ClusterIP 10.152.183.139 &lt;none&gt; 15010/TCP,15012/TCP,443/TCP,15014/TCP 29h
istio-system service/knative-local-gateway ClusterIP 10.152.183.216 &lt;none&gt; 80/TCP 21h
knative-serving service/activator-service ClusterIP 10.152.183.19 &lt;none&gt; 9090/TCP,8008/TCP,80/TCP,81/TCP,443/TCP 21h
knative-serving service/autoscaler ClusterIP 10.152.183.49 &lt;none&gt; 9090/TCP,8008/TCP,8080/TCP 21h
knative-serving service/autoscaler-bucket-00-of-01 ClusterIP 10.152.183.147 &lt;none&gt; 8080/TCP 21h
knative-serving service/autoscaler-hpa ClusterIP 10.152.183.156 &lt;none&gt; 9090/TCP,8008/TCP 21h
knative-serving service/controller ClusterIP 10.152.183.35 &lt;none&gt; 9090/TCP,8008/TCP 21h
knative-serving service/domainmapping-webhook ClusterIP 10.152.183.238 &lt;none&gt; 9090/TCP,8008/TCP,443/TCP 21h
knative-serving service/net-certmanager-controller ClusterIP 10.152.183.104 &lt;none&gt; 9090/TCP,8008/TCP 20h
knative-serving service/net-certmanager-webhook ClusterIP 10.152.183.227 &lt;none&gt; 9090/TCP,8008/TCP,443/TCP 20h
knative-serving service/net-istio-webhook ClusterIP 10.152.183.138 &lt;none&gt; 9090/TCP,8008/TCP,443/TCP 21h
knative-serving service/webhook ClusterIP 10.152.183.150 &lt;none&gt; 9090/TCP,8008/TCP,443/TCP 21h
kube-system service/kube-dns ClusterIP 10.152.183.10 &lt;none&gt; 53/UDP,53/TCP,9153/TCP 47h
metallb-system service/webhook-service ClusterIP 10.152.183.163 &lt;none&gt; 443/TCP 25h

NAMESPACE NAME DESIRED CURRENT READY UP-TO-DATE AVAILABLE NODE SELECTOR AGE
kube-system daemonset.apps/csi-nfs-node 1 1 1 1 1 kubernetes.io/os<span class="o">=</span>linux 30h
metallb-system daemonset.apps/speaker 1 1 1 1 1 kubernetes.io/os<span class="o">=</span>linux 25h

NAMESPACE NAME READY UP-TO-DATE AVAILABLE AGE
cert-manager deployment.apps/cert-manager 1/1 1 1 24h
cert-manager deployment.apps/cert-manager-cainjector 1/1 1 1 24h
cert-manager deployment.apps/cert-manager-webhook 1/1 1 1 24h
container-registry deployment.apps/registry 1/1 1 1 23h
default deployment.apps/helloworld-go-00001-deployment 0/0 0 0 19h
default deployment.apps/knative-operator 1/1 1 1 22h
default deployment.apps/operator-webhook 1/1 1 1 22h
istio-ingress deployment.apps/istio-ingressgateway 1/1 1 1 25h
istio-operator deployment.apps/istio-operator 1/1 1 1 25h
istio-system deployment.apps/istiod 1/1 1 1 29h
knative-serving deployment.apps/activator 1/1 1 1 21h
knative-serving deployment.apps/autoscaler 1/1 1 1 21h
knative-serving deployment.apps/autoscaler-hpa 1/1 1 1 21h
knative-serving deployment.apps/controller 1/1 1 1 21h
knative-serving deployment.apps/domain-mapping 1/1 1 1 21h
knative-serving deployment.apps/domainmapping-webhook 1/1 1 1 21h
knative-serving deployment.apps/net-certmanager-controller 1/1 1 1 20h
knative-serving deployment.apps/net-certmanager-webhook 1/1 1 1 20h
knative-serving deployment.apps/net-istio-controller 1/1 1 1 21h
knative-serving deployment.apps/net-istio-webhook 1/1 1 1 21h
knative-serving deployment.apps/webhook 1/1 1 1 21h
kube-system deployment.apps/coredns 1/1 1 1 47h
kube-system deployment.apps/csi-nfs-controller 1/1 1 1 30h
kube-system deployment.apps/hostpath-provisioner 1/1 1 1 23h
metallb-system deployment.apps/controller 1/1 1 1 25h

NAMESPACE NAME DESIRED CURRENT READY AGE
cert-manager replicaset.apps/cert-manager-5d6bc46969 1 1 1 24h
cert-manager replicaset.apps/cert-manager-cainjector-7d8b8bb6b8 1 1 1 24h
cert-manager replicaset.apps/cert-manager-webhook-5c5c5bb457 1 1 1 24h
container-registry replicaset.apps/registry-9865b655c 1 1 1 23h
default replicaset.apps/helloworld-go-00001-deployment-6466c46f55 0 0 0 19h
default replicaset.apps/knative-operator-7b7d4bbc7d 1 1 1 22h
default replicaset.apps/operator-webhook-74d9489bf8 1 1 1 22h
istio-ingress replicaset.apps/istio-ingressgateway-77b5b78896 0 0 0 25h
istio-ingress replicaset.apps/istio-ingressgateway-7f5958c7d9 1 1 1 25h
istio-operator replicaset.apps/istio-operator-79d6df8f9d 1 1 1 25h
istio-system replicaset.apps/istiod-57c965889 1 1 1 29h
knative-serving replicaset.apps/activator-658c5747b 1 1 1 21h
knative-serving replicaset.apps/autoscaler-f989fbf86 1 1 1 21h
knative-serving replicaset.apps/autoscaler-hpa-5d7668d747 1 1 1 21h
knative-serving replicaset.apps/controller-64b9dcc975 1 1 1 21h
knative-serving replicaset.apps/domain-mapping-7b87f895b6 1 1 1 21h
knative-serving replicaset.apps/domainmapping-webhook-54cddcb594 1 1 1 21h
knative-serving replicaset.apps/net-certmanager-controller-575898d58 1 1 1 20h
knative-serving replicaset.apps/net-certmanager-webhook-7cd899c855 1 1 1 20h
knative-serving replicaset.apps/net-istio-controller-84cb8b59fb 1 1 1 21h
knative-serving replicaset.apps/net-istio-webhook-8d785b78d 1 1 1 21h
knative-serving replicaset.apps/webhook-7698bcf68f 1 1 1 21h
kube-system replicaset.apps/coredns-7745f9f87f 1 1 1 47h
kube-system replicaset.apps/csi-nfs-controller-6f844cdc89 1 1 1 30h
kube-system replicaset.apps/hostpath-provisioner-58694c9f4b 1 1 1 23h
metallb-system replicaset.apps/controller-8467d88d69 1 1 1 25h

NAMESPACE NAME REFERENCE TARGETS MINPODS MAXPODS REPLICAS AGE
istio-ingress horizontalpodautoscaler.autoscaling/istio-ingressgateway Deployment/istio-ingressgateway &lt;unknown&gt;/80% 1 5 1 25h
istio-system horizontalpodautoscaler.autoscaling/istiod Deployment/istiod &lt;unknown&gt;/80% 1 5 1 29h
knative-serving horizontalpodautoscaler.autoscaling/activator Deployment/activator &lt;unknown&gt;/100% 1 20 1 21h
knative-serving horizontalpodautoscaler.autoscaling/webhook Deployment/webhook &lt;unknown&gt;/100% 1 5 1 21h

NAMESPACE NAME LATESTCREATED LATESTREADY READY REASON
default configuration.serving.knative.dev/helloworld-go helloworld-go-00001 helloworld-go-00001 True

NAMESPACE NAME CONFIG NAME K8S SERVICE NAME GENERATION READY REASON ACTUAL REPLICAS DESIRED REPLICAS
default revision.serving.knative.dev/helloworld-go-00001 helloworld-go 1 True 0 0

NAMESPACE NAME URL READY REASON
default route.serving.knative.dev/helloworld-go https://helloworld-go.default.s.taakcloud.com True

NAMESPACE NAME URL LATESTCREATED LATESTREADY READY REASON
default service.serving.knative.dev/helloworld-go https://helloworld-go.default.s.taakcloud.com helloworld-go-00001 helloworld-go-00001 True

NAMESPACE NAME URL READY REASON
default domainmapping.serving.knative.dev/hello.taakcloud.com https://hello.taakcloud.com True</code></pre></figure>


</details>

		</div>
		<div class="tutorial-share">
			<!--<a class="modalOpen no-smooth" href="#subscribe">
			<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/><path d="M0 0h24v24H0z" fill="none"/></svg>
		
 Subscribe</a>-->
			<a class="modalOpen no-smooth" href="#share">
			<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
				<path d="M0 0h24v24H0z" fill="none"/>
				<path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"/>
			</svg>
		
 Share</a>
		</div>
	</section>
</section>


	
	
	
	<div class="tutorial-series">
		<h3> - Series</h3>
		<p></p>

		<ul class="listing">
	
		<li class="active">
			<a href="/blog/go-serverless-and-save-the-planet/">
				<div class="icon">
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
			<path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/>
			<path d="M0 0h24v24H0z" fill="none"/>
		</svg>
</div>
				<article>
					<div>
						<h3>1. Go Serverless and save the planet</h3>
						<p class="description">Complete guide to self-host the Knative platform</p>
					</div>
				</article>
			</a>
		</li>
	
</ul>
	</div>




	<div class="related">
		<h3>Related tutorials</h3>

		<ul class="listing">
	
		<li >
			<a href="/products/web-push-notification/">
				<div class="icon">
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
			<path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/>
			<path d="M0 0h24v24H0z" fill="none"/>
		</svg>
</div>
				<article>
					<div>
						<h3>Web Push Notification</h3>
						<p class="description">Web push notification with ease on scale</p>
					</div>
				</article>
			</a>
		</li>
	
		<li >
			<a href="/getting-started/generate-api-key/">
				<div class="icon">
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
			<path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/>
			<path d="M0 0h24v24H0z" fill="none"/>
		</svg>
</div>
				<article>
					<div>
						<h3>Generate API Key</h3>
						<p class="description">Generate your first API Key</p>
					</div>
				</article>
			</a>
		</li>
	
		<li >
			<a href="/getting-started/create-app/">
				<div class="icon">
		<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
			<path d="M6 2c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6H6zm7 7V3.5L18.5 9H13z"/>
			<path d="M0 0h24v24H0z" fill="none"/>
		</svg>
</div>
				<article>
					<div>
						<h3>Create App</h3>
						<p class="description">Create your first App</p>
					</div>
				</article>
			</a>
		</li>
	
</ul>
	</div>




<div id="subscribe" class="modalDialog">
	<div>
		<a title="Close" class="close">&times;</a>
		<form action="" method="post">
			<h2>Subscribe</h2>
			<p>The latest tutorials sent straight to your inbox.</p>
			<input type="email" name="EMAIL" placeholder="Email">
			<input type="submit" value="Sign up">
		</form>
	</div>
</div>

<div id="share" class="modalDialog sharing">
	<div>
		<a title="Close" class="close">&times;</a>
		<h2>Share</h2>
		<p>Share this tutorial with your community.</p>
		<ul>
			<li><a class="twitter" target="_blank" href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fdocs.taakcloud.com%2Fblog%2Fgo-serverless-and-save-the-planet%2F">
	<svg class="twitter" height="24" viewBox="0 0 24 24" width="24"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg>
	
 Twitter</a></li>
			<li><a class="facebook" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fdocs.taakcloud.com%2Fblog%2Fgo-serverless-and-save-the-planet%2F">
		<svg class="facebook" xmlns="http://www.w3.org/2000/svg" width="25" height="25" viewBox="15.8 15.8 25 25"><path d="M32.8 24.7h-3.2v-2.1c0-0.8 0.5-1 0.9-1s2.3 0 2.3 0v-3.5l-3.1 0c-3.5 0-4.3 2.6-4.3 4.3v2.3h-2v3.6h2c0 4.6 0 10.2 0 10.2h4.2c0 0 0-5.6 0-10.2h2.8L32.8 24.7z"/></svg>
	
 Facebook</a></li>
			<li><a class="hacker-news" target="_blank" href="http://news.ycombinator.com/submitlink?u=https%3A%2F%2Fdocs.taakcloud.com%2Fblog%2Fgo-serverless-and-save-the-planet%2F&t=Go%20Serverless%20and%20save%20the%20planet">
		<svg class="hacker-news" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M18.8 3.3c-0.4 0.8-5.6 11.1-5.6 11.2 0 2 0 6.2 0 6.2 -0.1 0-2.2 0-2.3 0 0 0 0-5.9 0-6.2 0 0-5.5-10.9-5.6-11.1C5.3 3.3 5.3 3.3 5.3 3.3 5.3 3.3 5.3 3.3 5.3 3.3c0 0 0 0 0.1 0 0.9 0 1.7 0 2.6 0 0 0 0 0 0 0.1 0.1 0.1 4 8.3 4.1 8.3 0 0 4.2-8.3 4.3-8.4 0.8 0 1.6 0 2.4 0 0 0 0 0 0 0C18.8 3.3 18.8 3.3 18.8 3.3z"/></svg>
	
 Hacker News</a></li>
		</ul>
	</div>
</div>

<script src="/js/main.js"></script>

<script>
	var headings = document.querySelectorAll("h2[id]");

	//console.log(headings);
	for (var i = 0; i < headings.length; i++) {
		var anchorLink = document.createElement("a");
		anchorLink.innerText = "#";
		anchorLink.href = "#" + headings[i].id;
		anchorLink.classList.add("header-link");

		headings[i].appendChild(anchorLink);
	}

	$(".modalOpen").click(function() {
		var id = $(this).attr("href");
		$(id).addClass("show");

		$(window).click(function() {
			$(".show").removeClass("show");
		});

		$(id + " > div").click(function(event){
			event.stopPropagation();
		});
		return false;
	});

	$(".close").click(function() {
		$(".show").removeClass("show");
		return false;
	});

	$(document).keyup(function(e) {
		if (e.keyCode == 27) {
			$(".show").removeClass("show");
		}
	});
</script>

    </div>
  </main><footer>
	<div class="wrapper">
		<ul class="footer-links">
			
				<li><a target="_blank" href="https://github.com/taakcloud" class="Github-icon">
					
						
	  <svg class="github" height="24" viewBox="0 0 24 24" width="24"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg>
	

					
					</a></li>
			
				<li><a target="_blank" href="https://twitter.com/taakcloud" class="Twitter-icon">
					
						
	<svg class="twitter" height="24" viewBox="0 0 24 24" width="24"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg>
	

					
					</a></li>
			
		</ul>
		<p class="copyright">&copy; 2023, <a style="color:unset" href='https://taakcloud.com'>Taakcloud.com</a></p>
	</div>
</footer><script>
    $(function() {
      $('a[href*=\\#]').not(".no-smooth").on('click', function(event){
        var el = $(this.hash);
        if (el.length > 0) {
          // event.preventDefault();
          $('html,body').animate({scrollTop:$(this.hash).offset().top - 50}, 500);
        }
      });

      $('svg').click(function() {
        $(this).parent('form').submit();
      });
    });

    document.getElementById("open-nav").addEventListener("click", function (event) {
      event.preventDefault();
      document.body.classList.toggle("nav-open");
    });
  </script>
  <script>

  var elements = document.querySelectorAll('p');
  Array.prototype.forEach.call(elements, function(el, i){
      if(el.innerHTML=='[expand]') {
          var parentcontent = el.parentNode.innerHTML.replace('<p>[expand]</p>','<div class="expand" style="display: none; height: 0; overflow: hidden;">').replace('<p>[/expand]</p>','</div>');
          el.parentNode.innerHTML = parentcontent;
      }
  });

  var elements = document.querySelectorAll('div.expand');
  Array.prototype.forEach.call(elements, function(el, i){
      el.previousElementSibling.innerHTML = el.previousElementSibling.innerHTML + '<span>..&nbsp; <a href="#" style="cursor: pointer;" onclick="this.parentNode.parentNode.nextElementSibling.style.display = \'block\'; this.parentNode.parentNode.nextElementSibling.style.height = \'auto\'; this.parentNode.style.display = \'none\';">read&nbsp;more&nbsp;&rarr;</a></span>';
  });

</script>
</body>

</html>